var favoritePlaces=[{name:"Pike Place Market",street:"1517 Pike Place",lat:47.6101,lng:-122.3421,city:"Seattle"},{name:"Centurylink Field",street:"800 Occidental Ave S",lat:47.5952,lng:-122.3316,city:"Seattle"},{name:"Octo Sushi",street:"1621 12th Ave",lat:47.6158559,lng:-122.3178045,city:"Seattle"},{name:"Space Needle",street:"400 Broad St",lat:47.620412,lng:-122.349277,city:"Seattle"},{name:"Gas Works Park",lat:47.654941,lng:-122.335205,street:"2101 N Northlake Way",city:"Seattle"},{name:"Farmers' Market West Seattle",lat:47.56116,lng:-122.386807,street:"California Ave SW and SW Alaska St",city:"Seattle"},{name:"Volunteer Park",lat:47.630056,lng:-122.314932,street:"1247 15th Ave E",city:"Seattle"},{name:"Seward Park",lat:47.55067,lng:-122.25629,street:"5900 Lake Washington Blvd S",city:"Seattle"}],placesTypes=[{key:"restaurant",name:"Restaurants"},{key:"airport",name:"Airports"},{key:"aquarium",name:"Aquariums"},{key:"art_gallery",name:"Art Galleries"},{key:"atm",name:"ATMs"},{key:"bakery",name:"Bakeries"},{key:"bar",name:"Bars"},{key:"book_store",name:"Book Stores"},{key:"bus_station",name:"Bus Stations"},{key:"cafe",name:"Cafes"},{key:"fire_station",name:"Fire Stations"},{key:"hospital",name:"Hospitals"},{key:"library",name:"Libraries"},{key:"lodging",name:"Lodging"},{key:"movie_theater",name:"Movie Theaters"},{key:"museum",name:"Museums"},{key:"park",name:"Parks"},{key:"police",name:"Police Stations"},{key:"post_office",name:"Post Offices"},{key:"school",name:"Schools"},{key:"stadium",name:"Stadia"},{key:"subway_station",name:"Subway Stations"},{key:"train_station",name:"Train Stations"},{key:"veterinary_care",name:"Veterinary Offices"}],loadFile=function(a){var b=new XMLHttpRequest;b.overrideMimeType("application/json"),b.open("GET","js/weatherCodes.json",!0),b.onreadystatechange=function(){4==b.readyState&&"200"==b.status&&a(b.responseText)},b.send(null)},getWindDirection=function(a){var b=a;switch(!0){case b>0&&b<=11.25:return"Northerly";case b>11.25&&b<=35.75:return"North North Easterly";case b>35.75&&b<=56.25:return"North Easterly";case b>56.25&&b<=78.75:return"East North Easterly";case b>78.75&&b<=101.25:return"Easterly";case b>101.25&&b<=123.75:return"East South Easterly";case b>123.75&&b<=146.25:return"South Eastrly";case b>146.25&&b<=168.75:return"South South Easterly";case b>168.75&&b<=191.25:return"Southerly";case b>191.25&&b<=213.75:return"South South Westerly";case b>213.75&&b<=236.75:return"South Westerly";case b>236.75&&b<=258.75:return"West South Westerly";case b>258.75&&b<=281.25:return"Westerly";case b>281.25&&b<=303.75:return"West North Westerly";case b>303.75&&b<=326.25:return"North Westerly";case b>326.25&&b<=348.75:return"North North Westerly";case b>348.75&&b<=0:return"Northerly"}},initLocations=function(a){var b=ko.observableArray([]),c=0;return a.forEach(function(a){a.index=c++,b().push(new Place(a))}),b()},Model=function(){var a=this;this.defaultLocations=initLocations(favoritePlaces),this.nearbyVisible=ko.observable(!1),this.nearbyList=a.defaultLocations,this.placesTypes=ko.observableArray(placesTypes),this.currentPlace=this.defaultLocations[0],this.currentWeather=ko.observable(),this.weatherForecast=ko.observableArray(),this.weatherCodes=ko.observable(),loadFile(function(b){var c=JSON.parse(b);a.weatherCodes(c)})},Place=function(a){var b=this,c="WA",d=a.geometry?a.geometry.location.lat():a.lat,e=a.geometry?a.geometry.location.lng():a.lng;this.index=ko.observable(a.index),this.name=ko.observable(a.name),this.lat=ko.observable(d),this.lng=ko.observable(e),this.street=ko.observable(a.street),this.city=ko.observable(a.city),this.state=ko.observable(c),this.priceLevel=ko.observable(a.price_level),this.priceText=ko.computed(function(){var a="$";return"number"==typeof b.priceLevel()?a.repeat(b.priceLevel()):""}),this.ratings=ko.observable(a.rating),this.types=ko.observableArray(a.types),this.type=ko.observable(a.types?a.types[0]:"none"),this.address=ko.computed(function(){return b.street()+", "+b.city()+", "+b.state()}),this.requestAddress=ko.computed(function(){return b.address().replace(/ /g,"+")}),this.cssClass=ko.observable("show")},ViewModel=function(){var a=this;this.model=new Model,this.nearbyPlacesList=ko.observableArray([]),this.currentPlace=ko.observable(-1),this.filterString=ko.observable(""),this.selectedPlaceType=ko.observable(""),this.currentWeather=ko.computed(function(){return a.model.currentWeather()}),this.weatherCodes=ko.computed(function(){return a.model.weatherCodes()}),this.placesTypes=ko.computed(function(){return a.model.placesTypes()}),this.placesList=ko.computed(function(){return a.model.defaultLocations},this),this.placeType=ko.computed(function(){return a.selectedPlaceType()}),this.filterStringLength=ko.computed(function(){return a.filterString().length}),this.getCurrentPlace=ko.computed(function(){return a.currentPlace()==-1?-1:a.currentPlace().index()}),this.nearbyPlacesVisible=ko.computed(function(){return a.model.nearbyVisible()}),this.setCurrentPlace=function(b){"null"===b?(document.getElementById("search-text").className="",a.changeCSS("show"),a.currentPlace(-1)):(document.getElementById("search-text").className="hide-when-small",a.changeCSS("hide-when-small"),a.model.defaultLocations[b.index()].cssClass("show current-place"),a.currentPlace(a.model.defaultLocations[b.index()]))},this.changeCSS=function(b){a.model.defaultLocations.forEach(function(a){a.cssClass(b)})},this.searchPlaces=function(){gMap.searchPlacesByType(a.currentPlace(),a.placeType().key)},this.showDefault=function(b){return!(a.filterStringLength()>0)||!!a.model.defaultLocations[b()].name().includes(a.filterString())},this.createPlace=function(b){var c=0;b.forEach(function(b){b.index=c++,a.model.defaultLocations.push(new Place(b))})},this.clearPlaces=function(){a.nearbyPlacesList().length>0&&a.nearbyPlacesList.removeAll()},this.changeNearbyPlaces=function(a){var b=this;a.forEach(function(a){b.nearbyPlacesList.push(new Place(a))}),b.model.nearbyVisible(!0)},this.setCurrentWeather=function(b){b.readableCondition=a.weatherCodes()[b.weather[0].id].label,b.readableWindDirection=getWindDirection(b.wind.deg),a.model.currentWeather(b)}},viewModel=new ViewModel;ko.applyBindings(viewModel);
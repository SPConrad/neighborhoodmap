var favoritePlaces=[{name:"Pike Place Market",street:"1517 Pike Place",lat:47.6101,lng:-122.3421,city:"Seattle"},{name:"Centurylink Field",street:"800 Occidental Ave S",lat:47.5952,lng:-122.3316,city:"Seattle"},{name:"Octo Sushi",street:"1621 12th Ave",lat:47.6158559,lng:-122.3178045,city:"Seattle"},{name:"Space Needle",street:"400 Broad St",lat:47.620412,lng:-122.349277,city:"Seattle"},{name:"Gas Works Park",lat:47.654941,lng:-122.335205,street:"2101 N Northlake Way",city:"Seattle"},{name:"Farmers' Market West Seattle",lat:47.56116,lng:-122.386807,street:"California Ave SW and SW Alaska St",city:"Seattle"},{name:"Volunteer Park",lat:47.630056,lng:-122.314932,street:"1247 15th Ave E",city:"Seattle"},{name:"Seward Park",lat:47.55067,lng:-122.25629,street:"5900 Lake Washington Blvd S",city:"Seattle"}],placesTypes=[{key:"restaurant",name:"Restaurants"},{key:"airport",name:"Airports"},{key:"aquarium",name:"Aquariums"},{key:"art_gallery",name:"Art Galleries"},{key:"atm",name:"ATMs"},{key:"bakery",name:"Bakeries"},{key:"bar",name:"Bars"},{key:"book_store",name:"Book Stores"},{key:"bus_station",name:"Bus Stations"},{key:"cafe",name:"Cafes"},{key:"fire_station",name:"Fire Stations"},{key:"hospital",name:"Hospitals"},{key:"library",name:"Libraries"},{key:"lodging",name:"Lodging"},{key:"movie_theater",name:"Movie Theaters"},{key:"museum",name:"Museums"},{key:"park",name:"Parks"},{key:"police",name:"Police Stations"},{key:"post_office",name:"Post Offices"},{key:"school",name:"Schools"},{key:"stadium",name:"Stadia"},{key:"subway_station",name:"Subway Stations"},{key:"train_station",name:"Train Stations"},{key:"veterinary_care",name:"Veterinary Offices"}],loadFile=function(a){var b=new XMLHttpRequest;b.overrideMimeType("application/json"),b.open("GET","js/weatherCodes.json",!0),b.onreadystatechange=function(){4==b.readyState&&"200"==b.status&&a(b.responseText)},b.send(null)},getWindDirection=function(a){var b=a;switch(!0){case b>0&&b<=11.25:return"Northerly";case b>11.25&&b<=35.75:return"North North Easterly";case b>35.75&&b<=56.25:return"North Easterly";case b>56.25&&b<=78.75:return"East North Easterly";case b>78.75&&b<=101.25:return"Easterly";case b>101.25&&b<=123.75:return"East South Easterly";case b>123.75&&b<=146.25:return"South Eastrly";case b>146.25&&b<=168.75:return"South South Easterly";case b>168.75&&b<=191.25:return"Southerly";case b>191.25&&b<=213.75:return"South South Westerly";case b>213.75&&b<=236.75:return"South Westerly";case b>236.75&&b<=258.75:return"West South Westerly";case b>258.75&&b<=281.25:return"Westerly";case b>281.25&&b<=303.75:return"West North Westerly";case b>303.75&&b<=326.25:return"North Westerly";case b>326.25&&b<=348.75:return"North North Westerly";case b>348.75&&b<=0:return"Northerly"}},initLocations=function(a){var b=ko.observableArray([]),c=0;return a.forEach(function(a){a.index=c++,b().push(new Place(a))}),b()},Model=function(){var a=this;this.defaultLocations=initLocations(favoritePlaces),this.nearbyVisible=ko.observable(!1),this.nearbyList=a.defaultLocations,this.placesTypes=ko.observableArray(placesTypes),this.currentPlace=this.defaultLocations[0],this.currentNearbyPlace=ko.observable(),this.currentWeather=ko.observable(),this.weatherForecast=ko.observableArray(),this.weatherCodes=ko.observable(),loadFile(function(b){var c=JSON.parse(b);a.weatherCodes(c)})},Place=function(a){var b=this,c="WA",d=a.geometry?a.geometry.location.lat:a.lat,e=a.geometry?a.geometry.location.lng:a.lng;this.index=a.index,this.longName=a.name;for(var f=[],g=0;g<this.longName.length;g++)" "===this.longName[g]&&f.push(g);f.length>2?this.name=this.longName.slice(0,f[2])+"... ":this.name=this.longName,this.lat=d,this.lng=e,this.street=a.street,this.city=a.city,this.state=c,this.priceLevel=a.price_level,this.priceText="";var h="$";b.priceText=h.repeat(b.priceLevel),this.ratings=a.rating,this.types=a.types,this.type=a.types?a.types[0]:"none",this.address=b.street+", "+b.city+", "+b.state,this.requestAddress=b.address.replace(/ /g,"+"),this.cssClass=ko.observable("show"),this.hidden=ko.observable(!1),this.acceptedValue=ko.computed(function(){return b.hidden()})},ViewModel=function(){var a=this;this.model=new Model,this.nearbyPlacesList=ko.observableArray([]),this.currentPlace=ko.observable(-1),this.newFilter=ko.observable(""),this.getPlaceClickLink=function(a){if(null!==document.getElementById("favorite-place-"+a)){var b=document.getElementById("favorite-place-"+a);b.onclick=function(){gMap.setCurrentPlace(a)}}},this.filterString=ko.pureComputed({read:a.newFilter,write:function(b){b.length>0?a.model.defaultLocations.forEach(function(c){c.name.toLowerCase().includes(b.toLowerCase())?c.hidden()===!0&&(c.hidden(!1),gMap.changeDefault(c.index,"show"),a.getPlaceClickLink(c.index)):c.hidden()===!1&&(c.hidden(!0),gMap.changeDefault(c.index,"hide"))}):a.model.defaultLocations.forEach(function(b){b.hidden(!1),gMap.changeDefault(b.index,"show"),a.getPlaceClickLink(b.index)})},owner:this}),this.showDefault=function(b){return a.filterStringLength()>0?a.model.defaultLocations[b].name.toLowerCase().includes(a.filterString().toLowerCase())?(a.model.defaultLocations[b].hidden===!0&&(a.model.defaultLocations[b].hidden=!1,gMap.changeDefault(b,"show")),!0):(a.model.defaultLocations[b].hidden===!1&&(a.model.defaultLocations[b].hidden=!0,gMap.changeDefault(b,"hide")),!1):(a.model.defaultLocations.forEach(function(a){a.hidden===!0&&(gMap.changeDefault(a.index,"show"),a.hidden=!1)}),!0)},this.selectedPlaceType=ko.observable(),this.currentWeather=ko.computed(function(){return a.model.currentWeather()}),this.weatherCodes=ko.computed(function(){return a.model.weatherCodes()}),this.placesTypes=ko.computed(function(){return a.model.placesTypes()}),this.placesList=ko.computed(function(){return a.model.defaultLocations}),this.placeType=ko.computed(function(){return a.selectedPlaceType()}),this.filterStringLength=ko.computed(function(){return a.filterString().length}),this.getCurrentPlace=ko.computed(function(){return a.currentPlace()==-1?-1:a.currentPlace().index}),this.nearbyPlacesVisible=ko.computed(function(){return a.model.nearbyVisible()}),this.selectedNearbyPlace=ko.computed(function(){return a.model.currentNearbyPlace()}),this.setCurrentNearbyPlace=function(b){a.model.currentNearbyPlace(a.nearbyPlacesList()[b.index])},this.setCurrentPlace=function(b){"null"===b?(document.getElementById("search-text").className="",a.changeCSS("show"),a.currentPlace(-1)):(document.getElementById("search-text").className="hide-when-small",a.changeCSS("hide-when-small"),a.model.defaultLocations[b.index].cssClass("show current-place"),a.currentPlace(a.model.defaultLocations[b.index]))},this.changeCSS=function(b){a.model.defaultLocations.forEach(function(a){a.cssClass(b)})},this.changeNearbyCSS=function(a,b){document.getElementById("nearby-parent-"+a).className=b},this.searchPlaces=function(){a.clearPlaces(),gMap.searchPlacesByType(a.currentPlace(),a.placeType.key)},this.clearPlaces=function(){a.nearbyPlacesList().length>0&&a.nearbyPlacesList.removeAll()},this.changeNearbyPlaces=function(a){var b=this;a.forEach(function(a){b.nearbyPlacesList.push(new Place(a))}),b.model.nearbyVisible(!0)},this.setCurrentWeather=function(b){b.readableWindDirection=getWindDirection(b.windBearing),a.model.currentWeather(b)}},viewModel=new ViewModel;ko.applyBindings(viewModel);